---
import PageLayout from './PageLayout.astro';
import LeagueHeader from './LeagueHeader.astro';
import LeagueNav from './LeagueNav.astro';
import LatestEvent from './LatestEvent.astro';
import Top8Callout from './Top8Callout.astro';
import Leaderboard from './Leaderboard.astro';
import EventList from './EventList.astro';
import type { League, LeagueStanding, TournamentMetadata } from '../types';

interface Props {
  currentLeague: League | null;
  allLeagues: League[];
  isOverall: boolean;
  standings: LeagueStanding[] | null;
  tournaments: TournamentMetadata[];
  showLatestEvent?: boolean;
  top8Tournament?: TournamentMetadata | null;
}

const {
  currentLeague,
  allLeagues,
  isOverall,
  standings,
  tournaments,
  showLatestEvent = false,
  top8Tournament = null,
} = Astro.props;

// Get the latest tournament (first in the list, as they're sorted newest first)
const latestTournament = showLatestEvent && tournaments.length > 0 ? tournaments[0] : null;
---

<PageLayout>
  <LeagueHeader />
  <LeagueNav currentLeague={currentLeague} allLeagues={allLeagues} isOverall={isOverall} />
  {latestTournament && <LatestEvent tournament={latestTournament} />}
  {
    top8Tournament && currentLeague && (
      <Top8Callout tournament={top8Tournament} leagueName={currentLeague.name} />
    )
  }
  <Leaderboard standings={standings} />
  <EventList tournaments={tournaments} />
</PageLayout>
